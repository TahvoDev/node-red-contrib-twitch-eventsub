<script type="text/javascript">
    RED.nodes.registerType('twitch-eventsub-channel-redemption-add', {
      category: 'twitch events',
      color: '#b9a3e3',
      defaults: {
        name: { value: "" },
        config: { value: "", type: "twitch-api-config", required: true }
      },
      inputs: 0,
      outputs: 1,
      icon: 'twitch-icon.png',
      paletteLabel: "redeem",
      label: function() {
        if (this.name) {
          return this.name;
        }
        else {
          var config = RED.nodes.node(this.config);
          return 'redeem' + (config ? ' (' + (config.name || '') + ')' : '');
        }
      },
    });
  </script>
  
  <script type="text/html" data-template-name="twitch-eventsub-channel-redemption-add">
    <div class="form-row">
      <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
      <input type="text" id="node-input-name" placeholder="Name">
    </div>

    <div class="form-row">
      <label for="node-input-config"><i class="fa fa-cog"></i> Config</label>
      <input type="text" id="node-input-config" placeholder="">
    </div>
  </script>
  
  <script type="text/html" data-help-name="twitch-eventsub-channel-redemption-add">
      <h2>Twitch Channel Points Redemption</h2>
      <p>Listens for channel point redemptions in your Twitch channel and outputs the redemption details.</p>
  
      <h3>Configuration</h3>
      <ul>
          <li><strong>Name</strong>: Optional name for the node</li>
          <li><strong>Config</strong>: Select your Twitch Eventsub configuration</li>
      </ul>
      
      <h3>Output</h3>
      <p>Emits a message for each channel point redemption with the following properties:</p>
      
      <dl class="message-properties">
          <dt>payload <span class="property-type">object</span></dt>
          <dd>
              <ul>
                  <li>
                      <dt>userId <i>string</i></dt>
                      <dd>Twitch user ID of the viewer who redeemed the reward</dd>
                  </li>
                  <li>
                      <dt>userName <i>string</i></dt>
                      <dd>Twitch login name of the viewer</dd>
                  </li>
                  <li>
                      <dt>userDisplayName <i>string</i></dt>
                      <dd>Display name of the viewer</dd>
                  </li>
                  <li>
                      <dt>broadcasterId <i>string</i></dt>
                      <dd>Twitch user ID of the channel where the redemption occurred</dd>
                  </li>
                  <li>
                      <dt>broadcasterName <i>string</i></dt>
                      <dd>Twitch login name of the broadcaster</dd>
                  </li>
                  <li>
                      <dt>broadcasterDisplayName <i>string</i></dt>
                      <dd>Display name of the broadcaster</dd>
                  </li>
                  <li>
                      <dt>id <i>string</i></dt>
                      <dd>Unique identifier of the redemption</dd>
                  </li>
                  <li>
                      <dt>input <i>string</i></dt>
                      <dd>User input provided with the redemption (if any)</dd>
                  </li>
                  <li>
                      <dt>redemptionDate <i>Date</i></dt>
                      <dd>When the redemption occurred</dd>
                  </li>
                  <li>
                      <dt>rewardId <i>string</i></dt>
                      <dd>ID of the reward that was redeemed</dd>
                  </li>
                  <li>
                      <dt>rewardTitle <i>string</i></dt>
                      <dd>Title of the reward that was redeemed</dd>
                  </li>
                  <li>
                      <dt>rewardPrompt <i>string</i></dt>
                      <dd>Prompt shown to the user when redeeming the reward</dd>
                  </li>
                  <li>
                      <dt>rewardCost <i>number</i></dt>
                      <dd>Channel points cost of the reward</dd>
                  </li>
                  <li>
                      <dt>status <i>string</i></dt>
                      <dd>Status of the redemption (e.g., "UNFULFILLED", "FULFILLED")</dd>
                  </li>
                  <li>
                      <dt>rawEvent <i>object</i></dt>
                      <dd>Complete event data from Twitch API</dd>
                  </li>
              </ul>
          </dd>
      </dl>
  </script>